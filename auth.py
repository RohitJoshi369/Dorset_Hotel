# -*- coding: utf-8 -*-
"""auth.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1VxlXOqt7lc6xjwwqp7PjmzAjxxUuISIK
"""

import streamlit as st

def require_role(required_role: str):
    # Not logged in → go to login
    if not st.session_state.get("logged_in"):
        st.warning("Please login first.")
        st.switch_page("pages/1_Login.py")

    user_role = st.session_state.get("role")

    # Uploader has access to EVERYTHING
    if user_role == "uploader":
        return

    # Searcher can access ONLY search pages
    if required_role == "searcher" and user_role == "searcher":
        return

    # Otherwise → redirect
    if user_role == "searcher":
        st.switch_page("pages/3_Search_Bhagat.py")
    else:
        st.switch_page("pages/1_Login.py")
